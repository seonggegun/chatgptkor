# hotelreviewkor

# <div align=center> KOELECTRAλ¥Ό ν™μ©ν• νΈν…”λ¦¬λ·° ν‰μ  κ°μ„± λ¶„μ„ </div>
<img src = https://github.com/seonggegun/hotelreview/assets/79897862/3a2b34b4-1ba6-4325-a443-14907cbacdb2><br>
[μ¶μ²: bing create](https://www.bing.com/create)

# 1. κ°μ”
μ΄ ν”„λ΅μ νΈμ λ©μ μ€ KOELECTRAλ¥Ό ν™μ©ν•μ—¬ νΈν…” λ¦¬λ·°μ κΈλ¶€μ •μ„ μμΈ΅ν•κ³ μ ν•λ‹¤.<br> 
νΈν…” λ¦¬λ·°λ” νΈν…” μμ•½ κ³ κ°μ—κ² μ¤‘μ”ν• μ •λ³΄λ¥Ό μ κ³µν•λ” μ£Όμ” μ†μ¤λ΅ μ‚¬μ©λλ‹¤. μ΄λ¬ν• λ¦¬λ·°λ¥Ό ν†µν•΄ νΈν…”μ ν’μ§, μ„λΉ„μ¤ λ° μ‹μ„¤μ— λ€ν• μ •λ³΄λ¥Ό μ–»μ–΄ λ§μ΅±ν• λ§ μμ•½μ΄ κ°€λ¥ν• κ²ƒμ΄λ‹¤.

## 1.1 λ¬Έμ  μ •μ
νΈν…” λ¦¬λ·°λ” νΈν…” μμ•½μ— μμ–΄ κ°€μ¥ λ³΄νΈμ μΌλ΅ ν™μ©λλ” μ •λ³΄μ μ°½κµ¬μ΄λ‹¤.
νΈν…” λ¦¬λ·°λ” κ³ κ°λ“¤μ΄ μμ‹ μ κ²½ν—κ³Ό μκ²¬μ„ κ³µμ ν•κ³ , μ μ¬μ μΈ νΈν…” μμ•½ κ³ κ°μ—κ² μ¤‘μ”ν• κ²°μ •μ„ λ•λ” μ¤‘μ”ν• μ •λ³΄μ›μ΄λ©° μ΄λ¬ν• λ¦¬λ·°λ” νΈν…”μ μ„λΉ„μ¤ ν’μ§, μ‹μ„¤, μ„μΉ, μ²­κ²°λ„, κ°€κ²©, μμ‹ λ“± λ‹¤μ–‘ν• μΈ΅λ©΄μ„ λ‹¤λ£¨λ©°, κ³ κ°λ“¤μ΄ νΈν…”μ„ μ„ νƒν•κ±°λ‚ ν”Όν•λ” λ° ν° μν–¥μ„ λ―ΈμΉλ‹¤. λ” λ‚μ•„κ°€, νΈν…” λ¦¬λ·°λ” νΈν…” μ—…κ³„μ—μ„ ν’μ§ ν–¥μƒμ„ μ„ν• μ¤‘μ”ν• ν”Όλ“λ°± μ κ³µμλ΅μ„μ μ—­ν• μ„ ν•λ‹¤.<br>
[νΈν…” λ¦¬λ·°κ°€ νΈν…” μ„±ν–‰ μƒκ΄€κ΄€κ³„λ¥Ό λ‚νƒ€λ‚΄λ” μλ£](http://kmr.kasba.or.kr/xml/25550/25550.pdf)
μ΄ μλ£μ— λ”°λ¥΄λ©΄ νΈν…”μ μ μ¬ κ³ κ°λ“¤μ€ μ΄λ―Έ νΈν…” μƒν’μ„ μ†λΉ„ν•΄λ³Έ μ‚¬λλ“¤μ΄ κ²μ¬ν•λ” μ¨λΌμΈ λ¦¬λ·°λ¥Ό ν†µν•΄ λ” μ •ν™•ν•κ³  μ‹ λΆ°ν• λ§ν• μ •λ³΄λ¥Ό νƒμƒ‰ν•λ” κ²½ν–¥μ΄ μλ‹¤. λ”°λΌμ„, μ μ¬ κ³ κ°λ“¤μ΄ μ μ©μ„±μ„ μΈμ‹ν• μ¨λΌμΈ λ¦¬λ·°λ” κ·Έλ“¤μ κµ¬λ§¤κ²°μ •μ— μν–¥μ„ λ―ΈμΉλ” μ¤‘μ”ν• μ—­ν• μ„ ν•λ” κ²ƒμΌλ΅ λ‚νƒ€λ‚¬λ‹¤ .
## 1.2 λ°μ΄ν„° λ° λ¨λΈ κ°μ”
λ°μ΄ν„°λ” [κΉƒν—λΈ](https://github.com/Dabinnny/Review_SentimentAnalysis/tree/main/Data) μ €μ¥μ†μ—μ„ κ³µκ°λ ν¬λ΅¤λ§ν• νΈν…”λ¦¬λ·° λ°μ΄ν„°λ¥Ό μ‚¬μ©ν•μ—¬ ν•κµ­μ–΄ μμ—°μ–΄ μ²λ¦¬ λ¨λΈμΈ KOELECTRAλ¥Ό ν™μ©ν•μ—¬ νΈν…” λ¦¬λ·°μ κΈλ¶€μ • μμΈ΅μ„ ν•κ³ μ ν•λ‹¤.<br><br>

|Unnamed: 0|hotel|star|reviews|date|real_date|length|
| --- | --- | --- | --- | --- | --- | --- |
| λ²νΈ | νΈν…”λ… | λ³„μ  | λ¦¬λ·° | λ‚ μ§ | μ‹¤μ‹κ°„ | λ¬Έμ¥κΈΈμ΄ |


<img src = https://github.com/seonggegun/hotelreview/assets/79897862/2ece0c92-ec90-4da3-9117-bd7ec7a21da0> <br>
<table>
  <tr><th></th><th>λ³„μ </th><th>κ±΄μ</th></tr>
  <tr><th rowspan='2'>κΈμ • (21,281)</th><th>5</th><td>17,723</td></tr>
  <tr><th>4</th><td>3,558</td></tr>
  <tr><th rowspan='3'>λ¶€μ • (1637)</th><th>3</th><td>1,045</td></tr>
  <tr><th>2</th><td>291</td></tr>
  <tr><th>1</th><td>301</td></tr>
  <tr><th rowspan='1'>μ μ™Έ (3)</th><th>0</th><td>3(λΈ”λΌμΈλ“μ΅°μΉλ μ–Έν–‰)</td></tr>
  <tr><th colspan='2'>κ³„</th><td>22921</td></tr>
</table> <br>
κΈμ • 21,281 λ¶€μ • 1,637κ±΄μΌλ΅ κΈμ •λ¦¬λ·°κ°€ μ••λ„μ μΌλ΅ λ§μμ„ μ•μμλ‹¤.

# 2. λ°μ΄ν„°
## 2.1 λ°μ΄ν„° μ†μ¤
[νΈν…”λ¦¬λ·°λ°μ΄ν„°](https://github.com/Dabinnny/Review_SentimentAnalysis/tree/main/Data)
|Unnamed: 0|hotel|star|reviews|date|real_date|length|
| --- | --- | --- | --- | --- | --- | --- |
|0|κ·Έλλ“ ν•μ–νΈ μ„μΈ|5| μµκ³ μ μ£Όλ§ λ°μ΄νΈλ¥Ό ν–μµλ‹λ‹¤| 1μΌμ „ | 2022. 03. 14 |16|
|1|κ·Έλλ“ ν•μ–νΈ μ„μΈ|5| μ΅°μ‹ λ§›μ§‘π‘ | 2μΌμ „ | 2022. 03. 13 |6|
|2|κ·Έλλ“ ν•μ–νΈ μ„μΈ|5| μ•Όκ²½μ΄ λ„λ¬΄λ„λ¬΄ λ©‹μ΅μ–΄μ”^^ | 2022. 03. 07 | 2022. 03. 07 |15|
|3|κ·Έλλ“ ν•μ–νΈ μ„μΈ|4| μ²΄ν¬μΈ μ‹κ°„ μ „μ— λ„μ°© μ‹ λ€κΈ° ν•  κ³µκ°„μ΄ λ―Έν΅ν–λ κ²ƒκ°™κ³ , μ‹μ„¤ μ΄μ©ν•  μ μλ”κ² ν•μ •μ μ΄μ—¬μ„ μ•„μ‰¬μ›€μ΄ μ»Έμ | 2022. 03. 07 | 2022. 03. 07 |61|
| ... | ...| ... | ... | ... | ... | ... |
|22920|νλΌλ‹¤μ΄μ¤νΈν…”&λ¦¬μ΅°νΈ,νλΌλ‹¤μ΄μ¤μ‹ν‹°|5| λ„λ¬΄ ν–‰λ³µν–μ–΄μ© | 2019. 04. 12 | 2019. 04. 12 |8|
|22921|νλΌλ‹¤μ΄μ¤νΈν…”&λ¦¬μ΅°νΈ,νλΌλ‹¤μ΄μ¤μ‹ν‹°|5| μ •λ§ μΆ‹λ„¤μ”!! | 2019. 04. 07 | 2019. 04. 07 |8|
|22922|νλΌλ‹¤μ΄μ¤νΈν…”&λ¦¬μ΅°νΈ,νλΌλ‹¤μ΄μ¤μ‹ν‹°|5| λ§μ΄ ν•„μ” μ—†λ” μµκ³ ... λ„¤μ¤νΈλ‘ λΉ„κµ λ¶κ°€ | 2019. 03. 27 |2019. 03. 27 |25|<br>
## 2.2 νƒμƒ‰μ  λ°μ΄ν„° λ¶„μ„


## 2.3 λ°μ΄ν„° μ „μ²λ¦¬


|reviews|'star'|'label'|
| --- | --- | --- |
| νΈν…”λ¦¬λ·° | ν‰μ  | κΈμ •0,λ¶€μ •1 |
| μµκ³ μ μ£Όλ§ λ°μ΄νΈλ¥Ό ν–μµλ‹λ‹¤ | 5 | 0 |
| μ•Όκ²½μ΄ λ„λ¬΄λ„λ¬΄ λ©‹μ΅μ–΄μ”^^ | 5 | 0 |
| μΉμ ν•κ³  μ‹μ„¤λ„ μΆ‹λ„¤μ” | 5 | 0 |
| μ²΄ν¬μΈ μ‹κ°„ μ „μ— λ„μ°© μ‹ λ€κΈ° ν•  κ³µκ°„μ΄ λ―Έν΅ν–λ κ²ƒκ°™κ³ , μ‹μ„¤ μ΄μ©ν•  μ μλ”κ² ν•μ •μ μ΄μ—¬μ„ μ•„μ‰¬μ›€μ΄ μ»Έμ | 4 | 0 |
| λ‚μμ”μ•μ§€λ§ κ°€μ„±λΉ„λ¥Όλ”°μ§€μλ©΄ κ·Έλ‹¥.. | 3 | 1 |
| μ„λΉ„μ¤κ°€ λ‹¤ λ”°λ΅λ…Έλ” λλ‚μ΄λ„¤μ”..κΈ°λ€ν•κ³  κ°„κ³³μΈλ° κΈ°λ€μ΄ν•λ„¤μ” | 3 | 1 |
| λ°°λ“ λ°‘μ— λ­ κΉ”μ•„λ†“μΌμ…¨λ”μ§€ μΈν‰λ¶ν‰ν•΄μ„ ν—λ¦¬μ•„νμ„ μ μ„ λ»μ¤λ„¤μ” | 1 | 0 |
| κ°μΈ μ„μƒμ©ν’ μμ²΄κ°€ μ—†κ³ , λƒ‰λ°©κ³Ό λ‚λ°© λ‘ μ¤‘ ν•λ‚λ§ μ„ νƒ κ°€λ¥ν•©λ‹λ‹¤. | 2 | 0 | <br>
<img src = https://github.com/seonggegun/hotelreview/assets/79897862/c815c74c-11d9-4540-b41d-501969e5fc01 width="400" height="200">
<img src = https://github.com/seonggegun/hotelreview/assets/79897862/d59b1da7-9648-449b-ac13-8a2374564f4e width="400" height="200">


1. μ—‘μ…€λ‚΄μ—μ„ μ“Έλ¨μ—†λ” Unnamed, hotel(νΈν…”μ΄λ¦„), date(λ¦¬λ·°λ‚¨κΈ΄λ‚ μ§),real_date(μ‹¤μ  λ‚ μ§)λ¥Ό μ κ±°
2. ν‰μ  1&tilde;3μ μ€ λ¶€μ •(1), 4&tilde;5μ μ€ κΈμ •(0)μΌλ΅ λ³€ν™
3. κΈμ •λ°μ΄ν„° λ¶€μ •λ°μ΄ν„° λΉ„μ¨λ§μ¶”κΈ°
4. κ° μ „μ²λ¦¬ ν›„, κ²°μΈ΅μΉ ν™•μΈ<br>

```
def del_percent():
    has_missing_values = df.isnull().values.any()
print("κ²°μΈ΅μΉ ν™•μΈ =", has_missing_values)
# κ²°μΈ΅μΉκ°€ μμΌλ©΄ ν•΄λ‹Ή ν–‰ μ κ±°
if has_missing_values:
    df = df.dropna(how='any')
# μ²λ¦¬λ λ°μ΄ν„° κ°μ μ¶λ ¥
print("μ²λ¦¬λ λ°μ΄ν„° κ°μ =", len(df))
```
<br>
<img src= https://github.com/seonggegun/hotelreview/assets/79897862/18557f41-718a-46a7-a1af-797b667809b9 width="300" height="100"> <br>
2000κ° λ°μ΄ν„°μ— κ²°μΈ΅μΉλ” μ—†μμ„ μ•μμλ‹¤.<br>
5. νΉμ μ΄λ¨μ§€ λ° μ „μ²λ¦¬ <br>

```
import re
# 2. ~, !, ., >
def cleanText(readData):
 
    
    text = re.sub('[-=+,#/\?:;^$.@*\"β€»~&%γ†!γ€\\β€|\(\)\[\]\<\>`\'β€¦γ€‹β¤]', '', readData)
    return text

df['review'] = df['review'].apply(cleanText)
df['length'] = df['review'].apply(lambda x: len(x))
def cleanText2(readData):
 
    text = re.sub('[γ„±γ„΄γ„·γ„Ήγ…γ…‚γ……γ…‡γ…γ…γ…‹γ…γ…γ…γ…ƒγ…‰γ„Έγ„²γ…†γ…›γ…•γ…‘γ…γ…”γ…—γ…“γ…γ…£γ…γ… γ…΅]', '', readData)
    return text
df['review'] = df['review'].apply(cleanText2)
df['length'] = df['review'].apply(lambda x: len(x))
def cleanText3(readData):
    
    emoji_pattern = re.compile("["
        u"\U0001F600-\U0001F64F"  # emoticons
        u"\U0001F300-\U0001F5FF"  # symbols & pictographs
        u"\U0001F680-\U0001F6FF"  # transport & map symbols
        u"\U0001F1E0-\U0001F1FF"  # flags (iOS)
                           "]+", flags=re.UNICODE)

    text = emoji_pattern.sub(r'', readData)
    return text

df['review'] = df['review'].apply(cleanText3)
df['length'] = df['review'].apply(lambda x: len(x))
del_percent()
```
<br>
<img src= https://github.com/seonggegun/hotelreview/assets/79897862/b6bb2e43-d6ac-4cd6-ae00-69d3d2dce665><br>
μΆμ½μ΄ μ „μ²λ¦¬ μ „ μ°μ½μ΄ μ „μ²λ¦¬ ν›„ λ΅ μ΄λ¨μ§€κ°€ μ κ±°λ¨μ„ μ•μμλ‹¤.

```
# λ¨λΈ μ •μ
model = ElectraForSequenceClassification.from_pretrained('koelectra-small-v3-discriminator', num_labels=2)

# Optimizer λ° Scheduler μ„¤μ •
optimizer = torch.optim.Adam(model.parameters(), lr=3e-04, eps=1e-06, betas=(0.9, 0.999))
epoch = 3
scheduler = get_linear_schedule_with_warmup(optimizer, num_warmup_steps=0, num_training_steps=len(train_dataloader)*epoch)

# ν•™μµ λ° κ²€μ¦ λ£¨ν”„
for e in range(0, epoch):
    print(f'\n\nEpoch {e+1} of {epoch}')
    print(f'** ν•™μµ **')
    t0 = time.time()
    total_loss = 0
    model.train()
    for step, batch in enumerate(train_dataloader):
        # μ¤‘λµ
        
    # ν‰κ°€ λ£¨ν”„
    print('\n\n** κ²€μ¦ **')
    t0 = time.time()
    model.eval()
    eval_loss, eval_accuracy, eval_steps, eval_example = 0, 0, 0, 0
    for batch in validation_dataloader:
```

# 3. μ¬ν•™μµ κ²°κ³Ό
<img src = https://github.com/seonggegun/hotelreview/assets/79897862/6c66f7c2-e2d4-4b69-8748-c811b36294dd>

## 3.1 κ°λ° ν™κ²½
- <img src="https://img.shields.io/badge/PyCharm -000000?style=for-the-badge&logo=PyCharm&logoColor=white">      <img src="https://img.shields.io/badge/Python-3776AB?style=for-the-badge&logo=Python&logoColor=white">
<img src="https://img.shields.io/badge/PyTorch-EE4C2C?style=for-the-badge&logo=PyTorch&logoColor=red">   <img src="https://img.shields.io/badge/Numpy-013243?style=for-the-badge&logo=Numpy&logoColor=turquoise">
<img src="https://img.shields.io/badge/Pandas-150458?style=for-the-badge&logo=Pandas&logoColor=Dark Purple">      <img src="https://img.shields.io/badge/Transformers-007acc.svg"> <img src="https://img.shields.io/badge/Scikit-learn-F7931E?style=for-the-badge&logo=Scikit-learn&logoColor=orange">
## 3.2 KOELECTRA fine-tuning
22000κ±΄μ¤‘ κΈμ •μ΄ λ„λ¬΄ μ••λ„μ μΌλ΅ λ§μ•„ λ¶€μ • 1000κ±΄ κΈμ • 1000κ±΄λ§ μ¶”μ¶ν•μ—¬ μ§„ν–‰ν–λ‹¤.

**2000κ±΄μ λ¦¬λ·°λ°μ΄ν„°**
**μ¬ν•™μµμ½”λ“**
```
1 import pandas as pd
2 import numpy as np
3 from transformers import ElectraTokenizer, ElectraForSequenceClassification
4 from transformers import get_linear_schedule_with_warmup, logging
5 from sklearn.model_selection import train_test_split
.....
127 print("\n\n** λ¨λΈ μ €μ¥ **")
128 save_path = 'koelectra_small'
129 model.save_pretrained(save_path + ".pt")
130 print("\n** λ **")
```
**κ²°κ³Ό**
```
step : 10, loss : 0.6343773603439331
step : 20, loss : 0.5225526690483093
step : 30, loss : 0.5343009829521179
step : 40, loss : 0.5600367784500122
ν‰κ·  ν•™μµ μ¤μ°¨(loss) : 0.5551066684722901
ν•™μµμ— κ±Έλ¦° μ‹κ°„ : 0:09:56


 κ²€μ¦ 
κ²€μ¦ μ •ν™•λ„ : 0.7958916083916083
κ²€μ¦μ— κ±Έλ¦° μ‹κ°„ : 0:00:50


Epoch 2 of 3
 ν•™μµ 
step : 10, loss : 0.3833129107952118
step : 20, loss : 0.4971156418323517
step : 30, loss : 0.34031224250793457
step : 40, loss : 0.3076973855495453
ν‰κ·  ν•™μµ μ¤μ°¨(loss) : 0.4056156978011131
ν•™μµμ— κ±Έλ¦° μ‹κ°„ : 0:09:50


 κ²€μ¦ 
κ²€μ¦ μ •ν™•λ„ : 0.822333916083916
κ²€μ¦μ— κ±Έλ¦° μ‹κ°„ : 0:00:49


Epoch 3 of 3
 ν•™μµ 
step : 10, loss : 0.1980857253074646
step : 20, loss : 0.27155885100364685
step : 30, loss : 0.12263354659080505
step : 40, loss : 0.21949894726276398
ν‰κ·  ν•™μµ μ¤μ°¨(loss) : 0.32681176245212556
ν•™μµμ— κ±Έλ¦° μ‹κ°„ : 0:09:41


 κ²€μ¦ 
κ²€μ¦ μ •ν™•λ„ : 0.829763986013986
κ²€μ¦μ— κ±Έλ¦° μ‹κ°„ : 0:00:49
```
2μ²κ±΄μ λ°μ΄ν„°λ΅ μ •ν™•λ„κ°€ μ•½ **82%** μ •ν™•λ„λ¥Ό λ³΄μ—¬μ¤€λ‹¤
## 3.3 ν•™μµ κ²°κ³Ό κ·Έλν”„
<img src = https://github.com/seonggegun/hotelreview/assets/79897862/d319f1bf-51fb-4864-aff0-f3f1535f4f19><br>
ν‰κ·  ν•™μµ μ¤μ°¨κ°€ κ°μ†ν•κ³  κ²€μ¦ μ •ν™•λ„λ” μƒμΉν•λ©΄μ„ λ¨λΈμ΄ ν•™μµ λ°μ΄ν„°μ™€ κ²€μ¦ λ°μ΄ν„° λ¨λ‘μ—μ„ μ–‘νΈν• μ„±λ¥μ„ λ³΄μ΄κ³  μλ‹¤. 

μ΄λ” λ¨λΈμ΄ ν¨κ³Όμ μΌλ΅ ν•™μµλκ³  μλ‹¤λ” ν‘μ‹λ΅, μ μ ν• ν•™μµμ΄ μ΄λ£¨μ–΄μ§€κ³  μμμ„ μ•μμλ‹¤.

# 4. λ°°μ΄μ 
ν”„λ΅μ νΈλ¥Ό ν†µν•΄ λ°μ΄ν„° μ „μ²λ¦¬μ μ¤‘μ”μ„±μ„ κΉ¨λ‹¬μ•λ‹¤. μ›ν•λ” λ°μ΄ν„°λ¥Ό μ°Ύκ³  κ°€κ³µν•λ” κ³Όμ •μ΄ μƒλ‹Ήν μ–΄λ ¤μ› λ‹¤. νΉν, μ–΄λ–¤ λ°μ΄ν„°λ¥Ό μ„ λ³„ν•κ³  μ–΄λ–»κ² κ°€κ³µν• μ§€κ°€ λ¨λΈμ μ„±λ¥μ— ν° μν–¥μ„ λ―ΈμΉλ‹¤λ” κ²ƒμ„ μ•κ² λμ—λ‹¤.

λ°μ΄ν„°λ¥Ό μ„ λ³„ν•  λ•, κΈμ •κ³Ό λ¶€μ •μ λΉ„μ¨μ„ μ–΄λ–»κ² μ΅°μ ν•λ”μ§€κ°€ μ¤‘μ”ν• μ”μ† μ¤‘ ν•λ‚μ΄λ‹¤. ν• μ½μΌλ΅ μΉμ°μΉ ν•™μµ λ°μ΄ν„°λ” λ¨λΈμ΄ λ¶€μ •ν™•ν• κ²°κ³Όλ¥Ό λ‚΄λ†“μ„ κ°€λ¥μ„±μ„ λ†’μΌ μ μλ‹¤. λ”°λΌμ„ λ°μ΄ν„°μ κ· ν•μ„ μ μ§€ν•κ³  μ μ ν λ‹¤μ–‘ν• μΌ€μ΄μ¤λ¥Ό λ°μν•λ” κ²ƒμ΄ μ¤‘μ”ν•¨μ„ κΉ¨λ‹¬μ•λ‹¤.

μ΄λ¬ν• κ²½ν—μ„ ν†µν•΄ λ°μ΄ν„° μμ§‘μ κ³ μ¶©κ³Ό λ°μ΄ν„° μ „μ²λ¦¬κ°€ λ¨Έμ‹ λ¬λ‹ λ¨λΈμ μ„±λ¥μ— ν° μν–¥μ„ λ―ΈμΉλ‹¤λ” κ²ƒμ„ μΈμ§€ν•κ² λμ—κ³ , ν¨κ³Όμ μΈ μ „μ²λ¦¬κ°€ λ¨λΈμ ν’μ§ ν–¥μƒμ— κΈ°μ—¬ν•λ‹¤λ” κ²ƒμ„ κΉ¨λ‹¬μ•λ‹¤.
